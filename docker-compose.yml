services:
  backend:
    build: ./backend
    # 让容器保持运行，方便 Dev Container 连接
    command: sleep infinity
    volumes:
      - ./backend:/workspace/backend
    environment:
      # 请在本地创建 .env 文件或直接在这里填入 Key
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - TAVILY_API_KEY=${TAVILY_API_KEY}
    ports:
      - "8000:8000"

  frontend:
    build: ./frontend
    # 前端开启 host 模式以便 Docker 外部访问
    command: npm run dev -- --host
    volumes:
      - ./frontend:/workspace/frontend
      - /workspace/frontend/node_modules
    ports:
      - "5173:5173"
    environment:
      - VITE_API_URL=http://localhost:8000
